{"mappings":"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","sources":["js/reel.js"],"sourcesContent":["const Reel = function (canvas, offsetX = 0) {\n  //generate img objects for a reel\n  this.reelMap = conf.imgMap.shuffle().map((text, index) => ({\n    offsetY: conf.reel.height * conf.imgStartPts[index],\n    key: text,\n  }));\n  this.fnc = null;\n  this.spinning = false;\n  this.finalAnimation = false;\n  this.clickTime = 0;\n  this.showedLastAnim = false;\n  this.clicked = false;\n  this.mode = 'random';\n  this.fixedPlace = 'top';\n  this.fixedImg = 'BAR';\n  this.finalShapes = [];\n  //clear whole reel\n  const clear = function () {\n    canvas.clearRect(offsetX, conf.height, conf.reel.width, conf.height);\n  };\n\n  //draw image to specific point\n  const draw = function (key = 'BAR', offsetY = 0, blur = 0) {\n    if (conf.img.hasOwnProperty(key)) {\n      clear();\n\n      canvas.strokeStyle = '#000';\n      canvas.filter = `blur(${blur}px)`;\n      canvas.lineWidth = 4;\n      canvas.fillRect(offsetX, offsetY, conf.reel.width, conf.reel.height);\n      canvas.strokeRect(offsetX, offsetY, conf.reel.width, conf.reel.height);\n      canvas.drawImage(conf.img[key], offsetX, offsetY);\n      canvas.filter = 'none';\n    }\n  };\n\n  this.spinAnimation = function (skip) {\n    if (!this.spinning) return;\n\n    this.reelMap.forEach((img) => {\n      img.offsetY += conf.pSkip;\n\n      //reset prev and jump very top\n      if (img.offsetY >= conf.height) {\n        img.offsetY = conf.reel.height * -3;\n      }\n\n      //draw img object\n      draw(img.key, img.offsetY, 4);\n    });\n  };\n\n  this.generateReelShapesFixed = function () {\n    let imgMp = conf.imgMap.filter((x) => x !== this.fixedImg);\n    let rndImg2 = imgMp.rnd();\n    imgMp.splice(imgMp.indexOf(rndImg2), 1);\n    let rndImg3 = imgMp.rnd();\n    switch (this.fixedPlace) {\n      case 'top':\n        return [\n          {\n            offsetY: -60,\n            key: this.fixedImg,\n            stop: 0,\n          },\n          {\n            offsetY: 60,\n            key: rndImg2,\n            stop: 120,\n          },\n          {\n            offsetY: 180,\n            key: rndImg3,\n            stop: 240,\n          },\n        ];\n      case 'middle':\n        return [\n          {\n            offsetY: -120,\n            key: rndImg2,\n            stop: -60,\n          },\n          {\n            offsetY: 0,\n            key: this.fixedImg,\n            stop: 60,\n          },\n          {\n            offsetY: 120,\n            key: rndImg3,\n            stop: 180,\n          },\n        ];\n      default:\n        return [\n          {\n            offsetY: -180,\n            key: rndImg2,\n            stop: -120,\n          },\n          {\n            offsetY: -60,\n            key: rndImg3,\n            stop: 0,\n          },\n          {\n            offsetY: 60,\n            key: this.fixedImg,\n            stop: 120,\n          },\n        ];\n    }\n  };\n\n  this.generateReelShapesRandom = function () {\n    let imgMp = conf.imgMap.map((x) => x);\n    let rndImg1 = imgMp.rnd();\n    imgMp.splice(imgMp.indexOf(rndImg1), 1);\n    let rndImg2 = imgMp.rnd();\n    imgMp.splice(imgMp.indexOf(rndImg2), 1);\n    let rndImg3 = imgMp.rnd();\n\n    let rnd = [0, 60].rnd();\n    return [\n      {\n        offsetY: -120 + rnd,\n        key: rndImg1,\n        stop: -60 + rnd,\n      },\n      {\n        offsetY: 0 + rnd,\n        key: rndImg2,\n        stop: 60 + rnd,\n      },\n      {\n        offsetY: 120 + rnd,\n        key: rndImg3,\n        stop: 180 + rnd,\n      },\n    ];\n  };\n\n  this.setFinalShapes = function () {\n    switch (this.mode) {\n      case 'fixed':\n        return this.generateReelShapesFixed();\n        break;\n      default:\n        return this.generateReelShapesRandom();\n    }\n  };\n\n  this.spin2point = function () {\n    if (!this.finalAnimation) {\n      if (typeof this.fnc === 'function') {\n        this.fnc();\n        this.fnc = null;\n      }\n\n      return;\n    }\n\n    let stopPt;\n    this.finalShapes.forEach((img) => {\n      if (img.hasOwnProperty('stop')) {\n        stopPt = img.stop;\n      }\n      let inx = 6;\n      if (img.offsetY + inx === stopPt) {\n        this.finalAnimation = false;\n      }\n      img.offsetY += inx;\n\n      //draw img object\n      draw(img.key, img.offsetY);\n    });\n  };\n\n  this.done = function (fn) {\n    this.fnc = fn;\n  };\n};\n"],"names":["Reel","canvas","offsetX","this","reelMap","conf","imgMap","shuffle","map","text","index","offsetY","reel","height","imgStartPts","key","fnc","spinning","finalAnimation","clickTime","showedLastAnim","clicked","mode","fixedPlace","fixedImg","finalShapes","draw","blur","img","hasOwnProperty","clearRect","width","strokeStyle","filter","lineWidth","fillRect","strokeRect","drawImage","spinAnimation","skip","forEach","pSkip","generateReelShapesFixed","imgMp","x","rndImg2","rnd","splice","indexOf","rndImg3","stop","generateReelShapesRandom","rndImg1","setFinalShapes","spin2point","stopPt","done","fn"],"version":3,"file":"index.a640ba0d.js.map"}